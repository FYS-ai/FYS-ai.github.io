(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-010b7eaa"],{"3e22":function(e,s,t){"use strict";t.r(s);var i=function(){var e=this,s=e.$createElement,i=e._self._c||s;return i("div",[i("div",{staticClass:"sidebar"},[i("div",{staticClass:"hhhss"},[i("div",{staticClass:"myname"},[""!=e.$store.state.userList.user_photo?i("img",{staticClass:"myimg",attrs:{src:e.$store.state.userList.user_photo,alt:""}}):i("img",{staticClass:"myimg",attrs:{src:t("422b"),alt:""}}),i("div",{staticClass:"mymz"},[e._v(e._s(e.$store.state.userList.user_name))])]),i("div",{staticClass:"m-list"},[e._l(e.userList,(function(s,t){return i("div",{key:(new Date).getTime()+t+(new Date).getTime(),staticClass:"youname",class:e.acindex===t?"mylistactive":"",on:{click:function(i){return e.listClick(t,s.user_name,s.uid,s.user_photo)}}},[i("img",{staticClass:"myimg",attrs:{src:s.user_photo,alt:""}}),i("div",{staticClass:"mymz"},[e._v(e._s(s.user_name))])])})),e._l(e.sendChatList,(function(s,t){return i("div",{key:(new Date).getTime()+t,staticClass:"youname",class:e.sendacindex===t?"mylistactive":"",on:{click:function(i){return e.sendClick(t,s.user_name,s.uid,s.user_photo)}}},[i("img",{staticClass:"myimg",attrs:{src:s.user_photo,alt:""}}),i("div",{staticClass:"mymz"},[e._v(e._s(s.user_name))])])}))],2)]),i("div",{staticClass:"main"},[i("div",{staticClass:"m-top"},[i("div",{staticClass:"yonghum"},[e._v(" "+e._s(e.usertitle||e.sendusertitle)+" ")]),i("div",{staticClass:"yinc",class:""!=(e.userId||e.senduserId)?"showtexttarea":""},[e._l(e.receiverList,(function(s,t){return i("div",{key:(new Date).getTime()+t},[e.receiverList[t].user_name==e.usertitle?i("div",e._l(s.message,(function(s,t){return i("div",{key:t+(new Date).getTime()+(new Date).getTime()+(new Date).getTime()},[i("div",{staticClass:"chattime"},[e._v(e._s(s.time))]),i("div",{staticClass:"ltneirong"},[i("img",{staticClass:"lttouxiang",attrs:{src:e.photoredn||e.sendphotoredn,alt:""}}),i("div",{staticClass:"ltnrys"},[e._v(e._s(s.data))])])])})),0):e._e(),e.receiverList[t].user_name==e.sendusertitle?i("div",e._l(s.message,(function(s,t){return i("div",{key:t+(new Date).getTime()+(new Date).getTime()+(new Date).getTime()},[i("div",{staticClass:"chattime"},[e._v(e._s(s.time))]),i("div",{staticClass:"ltneirong"},[i("img",{staticClass:"lttouxiang",attrs:{src:e.photoredn||e.sendphotoredn,alt:""}}),i("div",{staticClass:"ltnrys"},[e._v(e._s(s.data))])])])})),0):e._e()])})),e._l(e.showChat,(function(s,t){return i("div",{key:(new Date).getTime()+(new Date).getTime()+t},e._l(s.messages,(function(t,n){return i("div",{key:n+(new Date).getTime()+(new Date).getTime()},[s.user_name==e.usertitle?i("div",[i("div",{staticClass:"chattime"},[e._v(e._s(t.time))]),i("div",{staticClass:"ltneirong rightys"},[i("div",{staticClass:"ltnrys zjltjl"},[e._v(e._s(t.data))]),i("img",{staticClass:"lttouxiang",attrs:{src:e.$store.state.userList.user_photo,alt:""}})])]):e._e(),s.user_name==e.sendusertitle?i("div",[i("div",{staticClass:"chattime"},[e._v(e._s(t.time))]),i("div",{staticClass:"ltneirong rightys"},[i("div",{staticClass:"ltnrys zjltjl"},[e._v(e._s(t.data))]),i("img",{staticClass:"lttouxiang",attrs:{src:e.$store.state.userList.user_photo,alt:""}})])]):e._e()])})),0)}))],2)]),i("div",{staticClass:"m-bto",class:""!=(e.userId||e.senduserId)?"showtexttarea":""},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:e.msg,expression:"msg"}],staticClass:"shuru",attrs:{type:"text",name:"",id:""},domProps:{value:e.msg},on:{input:function(s){s.target.composing||(e.msg=s.target.value)}}}),i("div",{staticClass:"fs",class:""!=e.msg?"fsshow":"",on:{click:e.fasongCilcik}},[e._v("发送")])])])])])},n=[],a=(t("c975"),t("d81d"),{name:"mymassege",data:function(){return{acindex:"",usertitle:"",photoredn:"",msg:"",userId:"",sendacindex:"",sendusertitle:"",sendphotoredn:"",senduserId:"",sessionList:{messages:[{data:"",time:""}],sender:"",id:""}}},computed:{userList:function(){return this.$store.state.userChat},sendChatList:function(){return this.$store.state.sendChat},showChat:function(){return this.$store.state.recordChat},receiverList:function(){return this.$store.state.receiverChat}},created:function(){var e=this;this.sockets.subscribe("sendMsgOn",(function(s){if(console.log("data的值",s),e.sendChatList.length>0){var t=e.sendChatList.map((function(e){return e.user_name})),i=t.indexOf(s[0].sender.user_name);if(console.log("data的值",s),console.log("filltt的值",t),console.log("fffgrger的值",i),e.userList.length>0){var n=e.userList.map((function(e){return e.user_name})),a=n.indexOf(s[0].sender.user_name);-1!=a?(e.$store.commit("receiverChatStore",{news:s[0].messages[s[0].messages.length-1],user_name:s[0].sender.user_name,morenzhi:"mrz"}),console.log("this.userChat有值，传过来的用户和this.userChat用户相同")):(e.$store.commit("receiverChatStore",{news:s[0].messages[s[0].messages.length-1],user_name:s[0].sender.user_name,morenzhi:"mrz"}),console.log("this.userChat有值，传过来的用户没有this.userChat用户相同"))}else if(-1!=i){if(s.length>1){var r=s.map((function(e){return e.user_name})),o=r.indexOf(e.$store.state.userList.user_name);console.log("lakd的值",r),console.log("lalall的值",o),e.sendChatList[o].user_name==s[0].sender.user_name&&-1!=o&&(s[i].messages.length>1&&e.$store.commit("receiverChatStore",{news:s[i].messages[s[i].messages.length-1],user_name:s[i].sender.user_name,morenzhi:i}),console.log("在同个用户添加messages",s[o].messages.length))}else e.$store.commit("receiverChatStore",{news:s[0].messages[s[0].messages.length-1],user_name:s[0].sender.user_name,morenzhi:"mrz"}),console.log("data长度等于1");console.log("直接添加")}else e.$store.commit("receiverChatStore",{news:s[0].messages[0],user_name:s[0].sender.user_name,morenzhi:"cxtj"}),e.$store.commit("sendChatStore",s[0].sender),console.log("在this.receiverChat添加一条新的记录")}else{var m=s.map((function(e){return e.user_name})),c=m.indexOf(e.$store.state.userList.user_name);if(e.userList.length>0){var u=e.userList.map((function(e){return e.user_name})),l=u.indexOf(s[0].sender.user_name);-1!=l?s[0].messages.length>1?(e.$store.commit("receiverChatStore",{news:s[c].messages[s[0].messages.length-1],user_name:s[c].sender.user_name,morenzhi:s[0].messages.length-1}),console.log("this.userList有相同的用户，并且data中的messages长度大于1，就不添加到sendChat，只添加到messages一条记录")):(e.$store.commit("receiverChatStore",{news:s[0].messages[0],user_name:s[0].sender.user_name,morenzhi:"mrz"}),console.log("this.userList有相同的用户，并且data中的messages长度等于1，就不添加到sendChat，只添加到messages一条记录")):(e.$store.commit("sendChatStore",s[0].sender),e.$store.commit("receiverChatStore",{news:s[0].messages[0],user_name:s[0].sender.user_name,morenzhi:"mrz"}),console.log("this.userList有值，但没有相同的用户，直接添加"))}else e.$store.commit("sendChatStore",s[c].sender),e.$store.commit("receiverChatStore",{news:s[0].messages[0],user_name:s[0].sender.user_name,morenzhi:"mrz"}),console.log("第一次添加记录")}}))},mounted:function(){var e=this;this.sockets.subscribe("ces",(function(e){})),this.sockets.subscribe("chatMsgOn",(function(s){console.log(s);var t=s.map((function(e){return e.sender.user_name})),i=t.indexOf(e.$store.state.userList.user_name);-1!=i?e.$store.commit("recordChatStore",s[i]):e.$store.commit("recordChatStore",s[0])}))},methods:{listClick:function(e,s,t,i){this.acindex=e,this.usertitle=s,this.userId=t,this.photoredn=i,this.sendacindex="",this.sendusertitle="",this.sendphotoredn=""},sendClick:function(e,s,t,i){this.sendacindex=e,this.sendusertitle=s,this.senduserId=t,this.sendphotoredn=i,this.acindex="",this.usertitle="",this.photoredn=""},fasongCilcik:function(){var e=this;this.msg?(this.sessionList.messages.map((function(s){s.data=e.msg,s.time=(new Date).toLocaleTimeString()})),this.sessionList.id=this.userId||this.senduserId,this.sessionList.user_name=this.usertitle||this.sendusertitle,this.sessionList.sender=this.$store.state.userList,this.$socket.emit("chatMsgEmit",this.sessionList),this.msg=""):alert("输入不能为空")}}}),r=a,o=(t("ec56"),t("2877")),m=Object(o["a"])(r,i,n,!1,null,"2026d096",null);s["default"]=m.exports},"422b":function(e,s,t){e.exports=t.p+"img/mytp.9af7e28e.png"},"47f0":function(e,s,t){},ec56:function(e,s,t){"use strict";t("47f0")}}]);
//# sourceMappingURL=chunk-010b7eaa.decb8f62.js.map